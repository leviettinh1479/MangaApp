<!doctype html>
<html lang="en">

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Modernize Free</title>
  <link rel="shortcut icon" type="image/png" href="/assets/images/logos/favicon.png" />
  <link rel="stylesheet" href="/assets/css/styles.min.css" />
  <link href='https://unpkg.com/boxicons@2.1.4/css/boxicons.min.css' rel='stylesheet'>

</head>

<body>
  <!--  Body Wrapper -->
  <div class="page-wrapper" id="main-wrapper" data-layout="vertical" data-navbarbg="skin6" data-sidebartype="full"
    data-sidebar-position="fixed" data-header-position="fixed">
    <!-- Sidebar Start -->
    <aside class="left-sidebar">
      <!-- Sidebar scroll-->
      <div>
        <div class="brand-logo d-flex align-items-center justify-content-between">
          <a href="./index.html" class="text-nowrap logo-img">
            <img src="/assets/images/logos/dark-logo.svg" width="180" alt="" />
          </a>
          <div class="close-btn d-xl-none d-block sidebartoggler cursor-pointer" id="sidebarCollapse">
            <i class="ti ti-x fs-8"></i>
          </div>
        </div>
        <!-- Sidebar navigation-->
        <nav class="sidebar-nav scroll-sidebar" data-simplebar="">
          <ul id="sidebarnav">
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">Home</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./index.html" aria-expanded="false">
                <span>
                  <i class="ti ti-layout-dashboard"></i>
                </span>
                <span class="hide-menu">Dashboard</span>
              </a>
            </li>
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">UI COMPONENTS</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./ui-buttons.html" aria-expanded="false">
                <span>
                  <i class="ti ti-article"></i>
                </span>
                <span class="hide-menu">Buttons</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./ui-alerts.html" aria-expanded="false">
                <span>
                  <i class="ti ti-alert-circle"></i>
                </span>
                <span class="hide-menu">Alerts</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./ui-card.html" aria-expanded="false">
                <span>
                  <i class="ti ti-cards"></i>
                </span>
                <span class="hide-menu">Card</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./ui-forms.html" aria-expanded="false">
                <span>
                  <i class="ti ti-file-description"></i>
                </span>
                <span class="hide-menu">Forms</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./ui-typography.html" aria-expanded="false">
                <span>
                  <i class="ti ti-typography"></i>
                </span>
                <span class="hide-menu">Typography</span>
              </a>
            </li>
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">AUTH</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./authentication-login.html" aria-expanded="false">
                <span>
                  <i class="ti ti-login"></i>
                </span>
                <span class="hide-menu">Login</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./authentication-register.html" aria-expanded="false">
                <span>
                  <i class="ti ti-user-plus"></i>
                </span>
                <span class="hide-menu">Register</span>
              </a>
            </li>
            <li class="nav-small-cap">
              <i class="ti ti-dots nav-small-cap-icon fs-4"></i>
              <span class="hide-menu">EXTRA</span>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./icon-tabler.html" aria-expanded="false">
                <span>
                  <i class="ti ti-mood-happy"></i>
                </span>
                <span class="hide-menu">Icons</span>
              </a>
            </li>
            <li class="sidebar-item">
              <a class="sidebar-link" href="./sample-page.html" aria-expanded="false">
                <span>
                  <i class="ti ti-aperture"></i>
                </span>
                <span class="hide-menu">Sample Page</span>
              </a>
            </li>
          </ul>
          <div class="unlimited-access hide-menu bg-light-primary position-relative mb-7 mt-5 rounded">
            <div class="d-flex">
              <div class="unlimited-access-title me-3">
                <h6 class="fw-semibold fs-4 mb-6 text-dark w-85">Upgrade to pro</h6>
                <a href="https://adminmart.com/product/modernize-bootstrap-5-admin-template/" target="_blank"
                  class="btn btn-primary fs-2 fw-semibold lh-sm">Buy Pro</a>
              </div>
              <div class="unlimited-access-img">
                <img src="/assets/images/backgrounds/rocket.png" alt="" class="img-fluid">
              </div>
            </div>
          </div>
        </nav>
        <!-- End Sidebar navigation -->
      </div>
      <!-- End Sidebar scroll-->
    </aside>
    <!--  Sidebar End -->
    <!--  Main wrapper -->
    <div class="body-wrapper">
      <!--  Header Start -->
      <header class="app-header">
        <nav class="navbar navbar-expand-lg navbar-light">
          <ul class="navbar-nav">
            <li class="nav-item d-block d-xl-none">
              <a class="nav-link sidebartoggler nav-icon-hover" id="headerCollapse" href="javascript:void(0)">
                <i class="ti ti-menu-2"></i>
              </a>
            </li>
            <li class="nav-item">
              <a class="nav-link nav-icon-hover" href="javascript:void(0)">
                <i class="ti ti-bell-ringing"></i>
                <div class="notification bg-primary rounded-circle"></div>
              </a>
            </li>
          </ul>
          <div class="navbar-collapse justify-content-end px-0" id="navbarNav">
            <ul class="navbar-nav flex-row ms-auto align-items-center justify-content-end">
              <a href="https://adminmart.com/product/modernize-free-bootstrap-admin-dashboard/" target="_blank"
                class="btn btn-primary">Download Free</a>
              <li class="nav-item dropdown">
                <a class="nav-link nav-icon-hover" href="javascript:void(0)" id="drop2" data-bs-toggle="dropdown"
                  aria-expanded="false">
                  <img src="/assets/images/profile/user-1.jpg" alt="" width="35" height="35" class="rounded-circle">
                </a>
                <div class="dropdown-menu dropdown-menu-end dropdown-menu-animate-up" aria-labelledby="drop2">
                  <div class="message-body">
                    <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                      <i class="ti ti-user fs-6"></i>
                      <p class="mb-0 fs-3">My Profile</p>
                    </a>
                    <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                      <i class="ti ti-mail fs-6"></i>
                      <p class="mb-0 fs-3">My Account</p>
                    </a>
                    <a href="javascript:void(0)" class="d-flex align-items-center gap-2 dropdown-item">
                      <i class="ti ti-list-check fs-6"></i>
                      <p class="mb-0 fs-3">My Task</p>
                    </a>
                    <a href="./authentication-login.html" class="btn btn-outline-primary mx-3 mt-2 d-block">Logout</a>
                  </div>
                </div>
              </li>
            </ul>
          </div>
        </nav>
      </header>
      <!--  Header End -->
      <div class="container-fluid">
        <div class="card">
          <div class="card-body" style="display: flex; justify-content: space-between;">
            {{#each mangaData}}
            <img src="{{this.image}}" style="object-fit: fill; border-radius: 20px; box-shadow: 0 0 8px #111;"
              width="30%" height="400" alt="Hình ảnh" />
            <div style="width: 68%;">
              <h1 style="color: #111;">{{this.name}}</h1>
              <div style="display: flex;">
                <div style="width: 30%;">
                  <p style="font-size: 20px; color: #111; align-items: center; font-weight: bold;">
                    <i class='bx bxs-user' style="font-size: 20px;"></i> Tác giả
                  </p>
                  <p style="font-size: 20px; color: #111; align-items: center; font-weight: bold;">
                    <i class='bx bx-wifi' style="font-size: 20px;"></i> Tình trạng
                  </p>
                  <p style="font-size: 20px; color: #111; align-items: center; font-weight: bold;">
                    <i class='bx bxs-like' style="font-size: 20px;"></i> Lượt thích
                  </p>
                  <p style="font-size: 20px; color: #111; align-items: center; font-weight: bold;">
                    <i class='bx bxs-happy-heart-eyes' style="font-size: 20px;"></i> Lượt xem
                  </p>
                </div>
                <div style="width: 70%;">
                  <p style="font-size: 20px; color: #111;">{{this.author}}</p>
                  <p style="font-size: 20px; color: #111;">Đang cập nhật</p>
                  <p style="font-size: 20px; color: #111;">236</p>
                  <p style="font-size: 20px; color: #111;">150,637</p>
                </div>
              </div>
              <div>
                <h3 style="color: #f18121;">
                  <i class='bx bxs-info-circle'></i> Giới thiệu
                </h3>
                <p style="font-size: 16px; color: #111;">Truyện tranh The Strongest Virus được cập nhật nhanh và đầy đủ
                  nhất tại TruyenQQ. Bạn đọc đừng quên để lại bình luận và chia sẻ, ủng hộ TruyenQQ ra các chương mới
                  nhất của truyện The Strongest Virus.</p>
              </div>
            </div>
          </div>
          <a href="/home/{{this._id}}/addchapter" class="btn btn-primary" style="align-self: center;width: 200;">Add Chapter</a>
        {{/each}}
          <div class="card-body">
            <h3 style="color: #f18121;">
              <i class='bx bxs-info-circle'></i> Danh sách chương
            </h3>
            {{#each chapterData}}
            <div style="border-width: 3px; border-color: #f18121;">
              <a href="http://localhost:3000/home/chapter/{{this._id}}">
                <div style="display: flex; justify-content: space-between; border-width: 3px;">
                  <div style="display: flex;">
                    <p style="font-size: 16px; color: #111;">Tập {{this.chap}}:</p>
                    <p style="font-size: 16px; color: #111; margin-left: 5px;">{{this.title}}</p>
                  </div>
                  <div>
                    <p style="font-size: 16px; color: #111;">28/05/2021</p>
                  </div>
                  <div>
              
              </div>
                </div>
              </a>
              <div class="row">
                <div class="col-1">
                  <button class="btn btn-danger" onclick="confirmDelete('{{this._id}}');">Delete</button>
                </div>
                <div class="col-1">
                  <a href="/home/{{this._id}}/updatechapter" class="btn btn-primary">Edit</a>
                </div>
              </div>
                
              {{/each}}
            </div>
          </div>
        </div>
      </div>
      <script src="/assets/libs/jquery/dist/jquery.min.js"></script>
      <script src="/assets/libs/bootstrap/dist/js/bootstrap.bundle.min.js"></script>
      <script src="/assets/js/sidebarmenu.js"></script>
      <script src="/assets/js/app.min.js"></script>
      <script src="/assets/libs/simplebar/dist/simplebar.js"></script>
      <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>
<script>
  const fetchAPI = async (url, option) => {
    const res = await fetch(url, option);
    return res.json();
  }

  const deleteChapter = async (id) => {
    const url = `/api/chapter/${id}`;
    const option = {
      method: 'delete',
      headers: { 'Content-Type': 'application/json' }
    }
    try {
      const result = await fetchAPI(url, option);
      console.log('Delete result: ', result);
      if (result.success === true) {
        window.location.reload();
      } else {
        swal('Xóa Thất bại!', {
          icon: 'error',
        });
      }
    } catch (e) {
      console.log('Delete error: ', e);
    }
  }

  const confirmDelete = (id) => {
    swal({
      title: "Xác nhận xóa?",
      text: "Bạn có chắc muốn xóa chapter này không?",
      icon: "warning",
      buttons: true,
      dangerMode: true,
    })
      .then((willDelete) => {
        if (willDelete) {
          deleteChapter(id);
        }
      });
  }
</script>
</body>

</html>